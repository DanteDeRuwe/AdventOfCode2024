// SEE ALSO AT TYPESCRIPT PLAYGROUND: https://www.typescriptlang.org/play/?#code/PTAEGECcFMBMEsAuBnAXAKBKAtKAqgHbwD2BAKsWQK4AOANtKAMbGyMBEARsZJMQO5x2oABaJENNCH4yAdCICGTANYN+CgJ4FoslgFtgiDTWjImkeDUTYWBAG7RI1qkVLZExd7QbYFvTdgapticVNYiAphguABKpoig8MigehqgAgSg-DzKoAB62Hno6EYmoBQAclR6nI4APACCoNAAHojQBLDJLsoEGQDaALoAfKAAvKAN-QDkDAQA5ogi04MA3MWljODELoh1Fc1tHV2gBNW1kAA0k4ftnd0EvQOD46BDoxNTsx2Lyy+tdxOFXQoFAAH5JiDQKgIDsCHsKtd+rIUQ1ri42AAzeDaWAjdYlYyMAD6AEkCEw6mRbsdkmcao4Pm8UbJtrsqcNrgAGQYzOa-FbrTagcmU6kA2mnc6M15kikcmn3KUMyDg0BysWjGHaByQAnCgAi0DFipO9IuTLZ8IVEqVyJROMxjkm6M60GxuMGUIhX35SxWUO10F1+qJoAAytVGqa6dKrqAAEIx5UW15WvYNUa2k722SO50NACMXtBEPTdQTWaOdpZ+dVCeLUNLzNRheuLIbvO+C39JdB0NOwccgcHIY2YeJAFkqHQ6lCmtnYyrLlCk4uU44V6CYsnzc6Jlz0EyF9WTly1eeYWvT8lzxCdzCpzPGtcjZTK9dI3o6jFrpnhqGZTTrOJ6AkuFzXNeYEbpATJPiBkFVtBe6QN66rAS+ibDCOOqOIBjANP4GhftG64oe8rygZK-R1qAABi8CQMgiDtg6BBOqqcTMX2EIMUxCRkXGTZqlxAk3jBQzCc2hGQJoJGiUhkooVJ-YQiRfHMX+RHyfEwzYf2BkDrhqGGUZQ4mf2Qa6iOXL4RGiAWAsDTIFUKpUtcO6CSqrxcky4riQABgAJAA3jEAC+AVoTEI7hg5OLzM5rkXO5IryjEel2eG9BIHFjnzHOoLhsmzH5VuEbQDQfgKB4qrrqVCVHq8xXrsFIW0XR4WheGlXVbVXXtexzoRVFzb9HRrGyNldC5fFCw-p+vWybVwx9jC-ThmsxRYGQskEMgNDEMg0B1P0-RtgATIMSIAMyXAALNdbwAKyXAAbIMIw4KMZ1tndz1Pf0F0Pe9n2EmUu0KPth3HaR4k9H0-AEEMFETCFUL9AA0okmTKNAGjEJikyDDC6MGVjF046AeME0TDQk5MFO8pjaygDtxX8PAdB0MwxB6PQCg4qAoQJEgWRczzzES1kORQuF6zy9tYB5QlBrwPMSAyZolRxsgp39OwN3sNc7D3ewgOm8boCG+bSLsBdVvsM9ttvOwhaO0bFtGybACcLsG971ue192DYD9-R3aAj1Ivd1w3YDwOgADSJtqA8e3dcPuA5H8desKKsLGrGuIAACoLTE6yqetQv50ENQsKPXVCnnieRvIvBMkl+cmNFDaqE2gLWfegKJPEj-EJVzfMjfCbxPcdanHVXSpvGFpP+Uqc2dGU-VU+b6p9n5UXSBl4xyCVxc1emdf4+afvpm5r+bwF4lLlxnUdGFpyh8JUl7-b6tPsN9QT6WATCGKN9wEqSgQZGBA4Yh2W2PCWSCoJi10lFDNIEIAAUfh5gwjIAASnGKMOwxB4CwDMmOYU2w7CoPKMmTBapsHELGKMakVk8Lg0YOSDitD6H9DIP8cS-QWEkJxhxEULwISkioVw4UvDHBIIcgoARQie64MgPgiRzpSSsNIeQvEapZGcL1Nw0AJd4AqAAPLaHoYoyAyiUEOKcao1xdR3FkD0plcxhASDkEoN4E6XjXiWJsXYkJ65aJ4DQgAURaEwOgVA2CpTwIpJUxlZ5vCEcJdaLI-GkAoNQegJ14mJOScE64aTv54DWqOLh5iAAyxBiDKFoMlRw1jMTWKYEwKgMAKSmEKqAZprTaDJgRhkcqMkJmPERsjJu25dxxh8k1T4vB57Dw0ixQebFJGjzQts5Moy2k0CySc9pcYuk9L6QMpgQyLk0A8vEa4oofx6VySMlppyOmQGub0-pHR7l60ec8zSI9QHgMQQoOgfS6A1WgOGFgMAr4jPdGJaCkykZDHKjEdWYhZlPGxYskeyyVRDFeF3V4jT0WbMkY01OQ96UHObAyslFwsngBhXChFSKeBDP3o00S5VTJ4vmGIEVhlH7XAwgy64jzfn-NuUCh5qcxViD0kA-soDQRwKhUrUO5jyQ0DCK8AKN1+z3XQPdfsN10CU1BM9dAa9QR2otaCH26B3VpwCnZRpOJTDNRyogF+dRjVhGuNMAAOgQaYAFzG-OQM5F+BTMgTGmrNfKdR-XaGQP0FCT1pj9jjUKMMvyX7JAmKmopQT9i62TVPVN8bhSJualPY+pdy7n2IImutKoK3xvMZDfaJcjpwFeMOg6Y6+2X2bWGGlmIEhoL2sgUdx1YD9B5KWso6ql3lBXWuuA50trmL5SitM3KZy8uRQ89FHl8WIEHcKLiM491a2IlGM9ph41YFBHkME6AgA

// Credits:
// - UnionToTuple code "borrowed" https://www.hacklewayne.com/typescript-convert-union-to-tuple-array-yes-but-how
// - Rest is my own work ^-^

type ToNumber<A extends unknown[]> = A['length'];

type Count<N extends number, A extends unknown[] = []> = A['length'] extends N
  ? A
  : Count<N, [...A, undefined]>;

type _Inc<T extends number> = [...Count<T>, 0]['length'];
type Inc<T extends number> = _Inc<T> extends number ? _Inc<T> : never;

type Dec<T extends number> = Count<T> extends [...infer A, undefined]
  ? A['length']
  : never;

type Sum<A extends number, B extends number> = Count<A> extends [...infer A1]
  ? Count<B> extends [...infer B1]
    ? [...A1, ...B1]['length']
    : never
  : never;

type _Mul<
  A extends number,
  B extends number,
  R extends number = 0
> = A extends 0 ? 0 : B extends 0 ? R : _Mul<A, Dec<B>, Sum<R, A>>;

type Mul<A extends number, B extends number> = _Mul<A, B> extends number
  ? _Mul<A, B>
  : never;

type ArraySum<A extends number[]> = A extends [infer First, ...infer Rest]
  ? First extends number
    ? Rest extends number[]
      ? ArraySum<Rest> extends number
        ? Sum<First, ArraySum<Rest>>
        : never
      : never
    : never
  : 0;

type StringAsNumber<T, R extends number = 0> = T extends `${R}`
  ? R
  : StringAsNumber<T, Inc<R>>;

type SplitString<
  S extends string,
  Separator extends string
> = S extends `${infer F}${Separator}${infer R}`
  ? [F, ...SplitString<R, Separator>]
  : [S];

// Transpose<[[1,2], [3,4], [5,6]]> -> [[1,3,5], [2,4,6]]
type Transpose<A extends unknown[][]> = {
  [K in keyof A]: {
    [K2 in keyof A]: A[K2][K]; // TS will complain but it will still work
  };
};

// StringDigitArrayToNumbers<[["3", "4"], ["4", "3"], ["2", "5"], ["1", "3"], ["3", "9"], ["3", "3"]]> --> [[3, 4], [4, 3], [2, 5], [1, 3], [3, 9], [3, 3]]
type StringDigitPairsToNumbers<
  T extends string[][],
  R extends number[][] = []
> = T extends [infer F, ...infer Rest]
  ? Rest extends string[][]
    ? F extends [infer F1, infer F2]
      ? F1 extends string
        ? F2 extends string
          ? StringDigitPairsToNumbers<
              Rest,
              [...R, [StringAsNumber<F1>, StringAsNumber<F2>]]
            >
          : R
        : R
      : R
    : R
  : R;

type Contra<T> = T extends any ? (arg: T) => void : never;
type Cov<T> = T extends any ? () => T : never;
type InferCov<T> = [T] extends [() => infer I] ? I : never;
type InferContra<T> = [T] extends [(arg: infer I) => void] ? I : never;
type PickOne<T> = InferContra<InferContra<Contra<Contra<T>>>>;
type UnionToTuple<T> = PickOne<T> extends infer U
  ? Exclude<T, U> extends never
    ? [T]
    : [...UnionToTuple<Exclude<T, U>>, U]
  : never;

type LookupNumberOfOccurences<
  Lookup extends unknown,
  Arr extends unknown[],
  R extends number = 0
> = Arr extends [infer First, ...infer Rest]
  ? First extends Lookup
    ? LookupNumberOfOccurences<Lookup, Rest, Inc<R>>
    : LookupNumberOfOccurences<Lookup, Rest, R>
  : R;

type CalculateScores<
  Left extends unknown[],
  Right extends unknown[],
  R extends number[] = []
> = Left extends [infer L1, ...infer LRest]
  ? L1 extends number
    ? CalculateScores<
        LRest,
        Right,
        [...R, Mul<L1, LookupNumberOfOccurences<L1, Right>>]
      >
    : R
  : R;

//--
type Input = `3   4
4   3
2   5
1   3
3   9
3   3`;

type Lines = SplitString<Input, '\n'>;
type NumbersAsStringUnion = SplitString<Lines[number], '   '>;
type NumberStrings = UnionToTuple<NumbersAsStringUnion>;
type Numbers = StringDigitPairsToNumbers<NumberStrings>;

type TransPosed = Transpose<Numbers>;
type Left = TransPosed[0];
type Right = TransPosed[1];

type Scores = CalculateScores<Left, Right>;

type Result = ArraySum<Scores>;
//   ^?
